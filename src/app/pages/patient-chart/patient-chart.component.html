<section class="w-full flex flex-col gap-4 custom-header-padding">
  <div class="page-header h-[42px] flex justify-between items-center w-full">
    <p-button
      #menubutton
      label="Patient Chart"
      icon="pi pi-arrow-left"
      [text]="true"
      class="p-3 font-medium"
      (click)="layoutService.onMenuToggle()"
    ></p-button>

    <div class="flex">
      <button
        pButton
        pRipple
        label="RPM"
        class="p-3 font-medium rounded-lg"
        [ngClass]="{
          'bg-[#6366F1] border-[#6366F1] text-white': activeRPMCCM === 'RPM',
          'bg-gray-100 border-none text-gray-700': activeRPMCCM !== 'RPM',
        }"
        (click)="setRPMCCM('RPM')"
      ></button>
      <button
        pButton
        pRipple
        label="CCM"
        class="p-3 font-medium"
        [ngClass]="{
          'bg-[#6366F1] border-[#6366F1] text-white': activeRPMCCM === 'CCM',
          'bg-gray-100 border-none text-gray-700': activeRPMCCM !== 'CCM',
        }"
        (click)="setRPMCCM('CCM')"
      ></button>
    </div>
  </div>

  <div class="w-full grid grid-cols-[40%_50%] bg-white shadow-md p-5 rounded-md justify-between items-start gap-4">
    <div class="col-span-2 flex flex-row gap-6">
      <div class="w-3/5 flex gap-4">
        <div class="flex flex-col gap-3">
          <img
            src="https://randomuser.me/api/portraits/men/75.jpg"
            alt="Patient Image"
            class="w-20 h-20 rounded-full"
          />
          <div class="flex justify-center text-center font-sans text-[12px] not-italic font-bold leading-[18px]">
            <p class="text-[#6366F1] cursor-pointer" (click)="setActiveTab('General')">Profile</p>
          </div>
        </div>
        <div class="w-full">
          <h2 class="text-[#101828] font-sans text-[14px] not-italic font-medium leading-[20px]">
            M "Minnie" Henderson Covington
          </h2>
          <div class="flex items-center gap-2 mt-2">
            <span class="badge bg-[#ECFDF3] text-[#027A48] py-1 px-2 rounded-full">English</span>
            <span class="badge bg-[#DCEFFF] text-[#6366F1] py-1 px-2 rounded-full">Female</span>
            <span class="badge bg-[#FFFAEB] text-[#B54708] py-1 px-2 rounded-full">76 y/o</span>
          </div>
          <div class="mt-4 space-y-1 text-[#666666]">
            <div class="flex flex-row justify-between">
              <p><img src="../../../assets/layout/styles/icons/call-outgoing.svg" /> Mobile</p>
              <p class="font-medium text-[#222]">
                (214) 284-0175 <i class="pi pi-pencil text-[#6366F1] underline cursor-pointer"></i>
              </p>
            </div>
            <div class="flex flex-row justify-between">
              <p><img src="../../../assets/layout/styles/icons/house.svg" /> Home</p>
              <p class="font-medium text-[#222]">
                (214) 284-0175 <i class="pi pi-pencil text-[#6366F1] underline cursor-pointer"></i>
              </p>
            </div>
            <p class="flex items-center gap-2">
              <img src="../../../assets/layout/styles/icons/hospital.svg" /> Alpha Medical Center
            </p>
            <p class="flex items-center gap-2">
              <img src="../../../assets/layout/styles/icons/profile-circle.svg" /> Dr. Austin Ogwu
            </p>
          </div>
          <div class="flex justify-end mt-3">
            <strong class="text-[#6366F1]">Patient Face Sheet</strong>
          </div>
        </div>
      </div>

      <div class="w-full flex gap-40 px-4" style="border-left: 1px solid rgba(128, 128, 128, 0.225)">
        <div class="flex flex-col text-[#666] font-sans not-italic font-normal leading-[normal]">
          <p>Place</p>
          <p>Diagnosis</p>
          <p>Care Type</p>
          <p>Program Type</p>
          <p>D.O.R</p>
          <p>Billing Cycle Start</p>
          <p>Time Spent</p>
        </div>

        <div class="flex-grow text-right font-normal">
          <div class="flex justify-between">
            <div class="font-medium text-[#222]">
              <p class="">Dallas, Texas</p>
              <p>HTN, Ventricular ectopic beat</p>
              <p>RPM</p>
              <p>Medicare</p>
              <div class="w-full flex items-center gap-3 mx-auto my-3">
                <div class="ml-7">7</div>
                <div>
                  <p-progressBar
                    class="p-progressbar-value p-progressbar-value-animate progressbar text-skyLight"
                    [value]="46"
                    [style]="{ height: '0.7rem', width: '8rem' }"
                    [showValue]="false"
                  ></p-progressBar>
                </div>
                <div>46%</div>
              </div>

              <p>Jul 6, 2024</p>
              <p class="float-right bg-[#F2F4F7] py-1 px-2 rounded-full">RPM: 0 mins</p>
            </div>
            <div class="flex flex-row gap-3 text-xl">
              <span class="text-[#6366F1] bg-[#DCEFFF] h-max p-2 rounded-full py-1.5 px-4">00:57 </span>
              <span class="text-[#B42318] h-max rounded-full">
                <i class="pi pi-stop-circle text-3xl mt-1"></i>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-span-2" style="border-top: 1px solid rgba(128, 128, 128, 0.225)"></div>

    <div class="col-span-2 flex flex-row justify-between">
      <div class="flex gap-x-2">
        <button
          pButton
          pRipple
          label="Call"
          icon="pi pi-phone"
          class="p-button-outlined border-gray-500 text-black"
        ></button>
        <button
          pButton
          pRipple
          label="Video"
          icon="pi pi-video"
          class="p-button-outlined border-gray-500 text-black"
        ></button>
        <button
          pButton
          pRipple
          label="Task"
          icon="pi pi-check-circle"
          class="p-button-outlined border-gray-500 text-black"
          (click)="selectTab(2)"
        ></button>
        <button
          pButton
          pRipple
          label="Messages"
          icon="pi pi-envelope"
          class="p-button-outlined border-gray-500 text-black"
        ></button>
      </div>

      <div class="flex gap-x-2">
        <button
          pButton
          pRipple
          [ngClass]="{
            ' bg-[var(--Background,_#FFF)] not-italic font-medium text-[#B42318] ': activeBtn !== 'PatientOnHold',
            ' rounded-[8px]  bg-[#B42318]  not-italic font-medium text-[var(--Background,_#FFF)] ':
              activeTab === 'PatientOnHold',
          }"
          label="Patient On Hold"
          class="p-button-danger"
          (click)="setActiveBtn('PatientOnHold')"
        >
          <i class="pi pi-clock mr-1"></i>
        </button>
        <button
          pButton
          pRipple
          [ngClass]="{
            ' bg-[var(--Background,_#FFF)] not-italic font-medium text-[#B42318] ': activeBtn !== 'PatientDischarge',
            ' rounded-[8px] border-[1px] border-[solid] border-[#F99D67] bg-[#B42318] not-italic font-medium text-[var(--Background,_#FFF)] ':
              activeTab === 'PatientDischarge',
          }"
          label="Discharge"
          class="p-button-danger"
          (click)="setActiveBtn('PatientDischarge')"
        >
          <i class="pi pi-user-minus mr-1"></i>
        </button>
      </div>
    </div>

    <div class="col-span-2" style="border-top: 1px solid rgba(128, 128, 128, 0.225)"></div>

    <div
      class="w-full col-span-2 bg-[#F2F4F7] p-3 rounded-md text-[#222] font-sans text-[14px] not-italic font-normal flex justify-between items-center"
    >
      <div class="flex items-center gap-2">
        <img src="../../../assets/layout/styles/icons/pinnedNotes.svg" />
        <span class="text-[#444444] text-[14px] font-sans not-italic leading-[20px] mr-6">Pinned Notes</span>

        <ng-container *ngIf="!isEditing; else editField">
          <span class="text-[#222] font-sans text-[14px] not-italic font-normal leading-[20px]">{{ value }}</span>
          <i class="pi pi-pencil cursor-pointer underline" (click)="editNotes()"></i>
        </ng-container>

        <ng-template #editField>
          <input
            type="text"
            [(ngModel)]="newValue"
            class="border border-b-gray-300 border-t-transparent border-x-transparent rounded p-1 w-[300px]"
          />
          <button (click)="updateNotes()" class="bg-[#6366F1] border-none text-white rounded p-1">Update</button>
        </ng-template>
      </div>
      <span class="text-[#222222]">Jan 1, 2024</span>
    </div>
    <div class="col-span-2">
      <button
      class="font-sans bg-[#FFFFFF] px-0 py-[10px] text-[14px] not-italic font-medium leading-[20px] cursor-pointer mr-3"
        [ngClass]="{ 'border-x-0 border-t-0 border-b-[1.5px] border-b-[#6366F1] text-[#6366F1] font-bold': activeTab === 'General',
          'border-none font-[500] text-[#667085]': activeTab !== 'General'
         }"
        (click)="setActiveTab('General')"
      >
        General
      </button>
      <button
        class="font-sans bg-[#FFFFFF] px-0 py-[10px] text-[14px] not-italic font-medium leading-[20px] cursor-pointer"
        [ngClass]="{ 'border-x-0 border-t-0 border-b-[1.5px] border-b-[#6366F1] text-[#6366F1] font-bold ': activeTab === 'RPM Settings',
          'border-none font-[500] text-[#667085]': activeTab !== 'RPM Settings'
         }"
        (click)="setActiveTab('RPM Settings')"
      >
        RPM Settings
      </button>
    </div>
  </div>

  <div class="card m-[-6px]">
    <div *ngIf="activeTab === 'General'">
      <div class="flex bg-gray-100 items-start rounded-lg">
        <div class="w-full bg-gray-100 rounded-lg">
          <div class="w-full flex flex-row justify-between">
          <div class="w-1/3 mt-2">
            <ul class="gap-2 list-none">
              <li
              *ngFor="let section of profileSections"
              class="cursor-pointer px-3 py-2 rounded-lg m-3 text-[#222] font-[Inter] text-[14px] not-italic font-medium leading-[normal] "
              [ngClass]="{
                'text-[#757575]': activeProfileItem.title !== section.title,
                'text-[#6366F1] rounded-[6px] bg-[var(--Background,_#FFF)] [box-shadow:0px_1px_3px_0px_rgba(16,_24,_40,_0.10),_0px_1px_2px_0px_rgba(16,_24,_40,_0.06)]': activeProfileItem.title === section.title,
              }"
                (click)="setActiveProfileItem(section)"
                >
                {{ section.title }}
              </li>
            </ul>
          </div>
          
        
          
          <div class="w-full grid grid-cols-3 gap-4 p-6">
            <div class="col-span-3 flex justify-end items-center gap-4">
                <i class="pi pi-pencil text-[#6366F1] underline mr-[-1rem]"></i>
                <p class="text-[#6366F1]">Edit Details</p>
            </div>
            <div *ngFor="let item of activeProfileItem.data" class="bg-white p-4 rounded-lg shadow-md">
              <div class="flex flex-row justify-between">
                <p class="text-[#666] font-sans text-[14px] not-italic font-medium leading-[normal]">{{ item.label }}</p>
                <i class="pi pi-pencil text-blue-400 underline"></i>
              </div>
              <p class="text-[#222] font-sans text-[14px] not-italic font-medium leading-[normal]">{{ item.value }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
    
    <div *ngIf="activeTab === 'RPM Settings'">

      <div class="p-tabView">
        <div class="tab-buttons mb-2">
          <button
            class="mr-3 bg-[#FFFFFF] px-0 py-[10px] cursor-pointer text-[14px]"
            (click)="setActiveRpmSubTab(0)"
            [ngClass]="{ 'border-t-0 border-x-0 border-b-2 border-b-[#6366F1] text-[#6366F1]': activeRpmSubTabIndex === 0 ,
              ' border-none text-[#9CA3AF]': activeRpmSubTabIndex !== 0
            }"
          >
            Alerts
          </button>
          <button
          class="mr-3 bg-[#FFFFFF] px-0 py-[10px] cursor-pointer text-[14px]"
          (click)="setActiveRpmSubTab(1)"
          [ngClass]="{ 'border-t-0 border-x-0 border-b-2 border-b-[#6366F1] text-[#6366F1]': activeRpmSubTabIndex === 1 ,
            ' border-none text-[#9CA3AF]': activeRpmSubTabIndex !== 1
          }"
            >
              Vitals
          </button>
          <button
            class="mr-3 bg-[#FFFFFF] px-0 py-[10px] cursor-pointer text-[14px]"
            (click)="setActiveRpmSubTab(2)"
            [ngClass]="{ 'border-t-0 border-x-0 border-b-2 border-b-[#6366F1] text-[#6366F1]': activeRpmSubTabIndex === 2 ,
              ' border-none text-[#9CA3AF]': activeRpmSubTabIndex !== 2
            }"
          >
            Tasks
          </button>
        </div>

        <div *ngIf="activeRpmSubTabIndex === 0">
          <intracare-table [columns]="columns" [rowData]="patients" [rowsPerPage]="[10, 25, 50]" />
        </div>
        
        <div *ngIf="activeRpmSubTabIndex === 1">
          <p>Vitals content goes here...</p>
        </div>
        
        <div *ngIf="activeRpmSubTabIndex === 2">
          <p>Tasks content goes here...</p>
        </div>
      </div>
    </div>
  </div>
  <ng-template #patientCardTemplate let-row>
    <p class="font-bold">{{ row.name }}</p>
    <p>DOB {{ row.dob }}</p>
  </ng-template>

  <ng-template #programTypeTemplate let-row>
    <p class="font-bold">{{ row.programType }}</p>
  </ng-template>
  <ng-template #statusTemplate let-row>
    <p class="bg-skyLight text-[#6366F1] text-center rounded-full inline-block w-auto px-2.5 py-1">
      {{ row.status }}
    </p>
  </ng-template>

  <ng-template #progressTemplate let-row>
    <div class="flex flex-col">
      <p>{{ row.progress }}%</p>
      <p-progressBar
        class="p-progressbar-value p-progressbar-value-animate progressbar text-skyLight"
        [value]="row.progress"
        [style]="{ height: '4px' }"
        [showValue]="false"
      ></p-progressBar>
    </div>
  </ng-template>

  <ng-template #consentTemplate let-row>
    <p class="bg-lime-50 text-lime-600 text-center px-[1px] rounded-lg">
      {{ row.consent }}
    </p>
  </ng-template>
  <ng-template #editUpdateTemplate let-row>
    <i
      (click)="openUpdateModal()"
      class="cursor-pointer mr-2 text-[15px] text-[#667085] not-italic flex-shrink-0"
      >Update</i
    >
    <i (click)="openEditModal()" class="cursor-pointer text-[15px] text-[#6366F1] not-italic flex-shrink-0"
      >Edit</i
    >
  </ng-template>
</section>
